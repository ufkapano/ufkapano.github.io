<html>
<head>
<title>Procesy</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2">
</head>

<body bgcolor="white" text="black" link="blue" vlink="navy" alink="red">

<h1>Procesy i sygna³y</h1>

<h3>PROCESY</h3>

<p>Istniej± komendy wewnêtrzne shella <em>bash</em> do dzia³ania na procesach:
<em>jobs</em>, <em>fg</em>, <em>bg</em>, <em>kill</em>.

<p>Komendy zewnêtrzne:
<em>ps</em>, <em>top</em>.

<p>Proces uruchomiony jako pierwszoplanowy zatrzymujemy przez 
<strong>[Ctrl]+[z]</strong>. 
Polecenie <em>jobs</em> nazywa go <em>Stopped</em>.
Proces uruchomiony w tle <em>jobs</em> nazywa <em>Running</em>.
Proces <em>Stopped</em> mo¿e byæ kontynuowany przez
<em>fg</em> lub <em>bg</em>.

<h3>SYGNA£Y</h3>

<p>Z uruchomionymi procesami mo¿emy komunikowaæ siê miêdzy innymi przez
wysy³anie do nich sygna³ów. Sygna³y s± zestandaryzowane. 
Maj± przyporz±dkowane numery i nazwy pisane du¿ymi literami.
Do procesów pierwszoplanowych mo¿emy wysy³aæ niektóre sygna³y
za pomoc± stosownych kombinacji klawiszowych.
Polecenie <em>kill</em> umo¿liwia wysy³anie ró¿nych sygna³ów do procesów
pierwszoplanowych i drugoplanowych.
Polecenie <em>kill -l</em> daje listê sygna³ów które mo¿e wysy³aæ
<em>kill</em>.
Jest plik <em>/usr/include/linux/signal.h</em> z tym zwi±zany.

<h3>WYBRANE SYGNA£Y</h3>

<ul>
<li>Sygna³ 2 (SIGINT) - przerwanie wykonania procesu nakazane 
z klawiatury; mo¿na przez [Ctrl]+[c]

<li>Sygna³ 3 (SIGQUIT) - przerwanie wykonania procesu nakazane 
z klawiatury po³±czone ze zrzuceniem <em>core</em> (obrazu pamiêci procesu);
mo¿na przez [Ctrl]+[\]

<li>Sygna³ 9 (SIGKILL) - zabicie procesu

<li>Sygna³ 15 (SIGTERM) - miekkie zakoñczenie procesu, 
domy¶lne dla <em>kill</em>

<li>Sygna³ 19 (SIGSTOP) - zatrzymanie wykonywania procesu, z mo¿liwo¶cia
pó¿niejszego wznowienia jego wykonywania (przez <em>fg</em> lub <em>bg</em>);
mo¿na przez [Ctrl]+[z]
</ul>

<h3>INNE POLECENIA</h3>

<p>Polecenia <em>lsof</em> i <em>fuser</em> mo¿na wykorzystaæ
do znalezienia w³a¶cicieli procesów lub portów.

<ul>
<li><em>lsof</em> - wy¶wietl otwarte pliki.
<li><em>fuser</em> - podaj procesy korzystaj±ce z plików.
</ul>

<h3>PRZYK£ADY</h3>

</pre><hr><pre>
$ polecenie1 &amp;                     (uruchamianie zadañ w tle)
$ ls -R / &gt; lista.txt 2&gt; error.txt &amp;
         (przyk³ad z przekierowaniem stdout i stderr)
$ nohup polecenie1 &amp;
	(nohup zapobiega zatrzymaniu procesu przy wylogowaniu u¿ytkownika;
	wyj¶cie procesu jest kierowane do pliku ~/nohup.out)
</pre><hr><pre>
$ jobs           (list active jobs; wypisze [1], [2] itd.)
$ jobs -l         (wypisze te¿ PID procesów)
</pre><hr><pre>
$ fg %3
	(przeniesienie zadania [3] zatrzymanego przez [Ctrl]+[z] 
	lub wykonywanego w tle do pierwszego planu)
$ fg %-            (poprzednie zadanie)
$ fg %+            (bie¿±ce zadanie)
$ fg                (brak numeru oznacza bie¿±ce zadanie)
$ fg -x 536         (to samo dla zadania z PID=536)
</pre><hr><pre>
$ bg %2
	(przeniesienie zatrzymanego przez [Ctrl]+[z] zadania 
	do drugiego planu w celu kontynuacji wykonywania)
$ bg     (brak numeru oznacza bie¿±ce zadanie; opcje jak dla "fg")
</pre><hr><pre>
$ kill -l         (lista sygna³ów, które mo¿e wysy³aæ kill)
$ kill 465        (miekkie zabicie procesu z PID=465)
$ kill -9 %2      (brutalne zabicie procesu [2])
$ kill -SIGKILL %2          (to samo co wy¿ej)
$ kill $!         (zabicie ostatniego procesu przes³anego do t³a)
</pre><hr><pre>
UWAGA opcje polecenia ps zale¿± od jego wersji!
$ ps         (process status)
Opcje bez minusa daj± zachowanie BSD.
Opcje z minusem daj± zachowanie Unix98.
Opcje z dwoma minusami to GNU long options.
Obecnie ps w Linuksie korzysta z systemu plików proc.

Opcje wyboru procesów:
$ ps a            (wszystko z moim TTY)
$ ps u           (d³ugi opis procesów)
$ ps x            (wszystko z moim USER)
$ ps aux|less     (wszystkie procesy w systemie)
$ ps -a            (wszystkie z tty)
$ ps -e            (wszystko)

Opcje formatowania wyjscia:
$ ps -f            (forest - format drzewiasty)
$ ps -l            (long format)
$ ps -j            (jobs format)
</pre><hr><pre>
$ top               (display top CPU precesses)
$ top -s           (secure - pewne polecenia sa blokowane)
$ who              (kto i na jakim terminalu jest zalogowany)
$ who I am         (kim ja jestem w tej chwili)
</pre><hr><pre>
# lsof -i :numer_portu
# fuser -v -n tcp numer_portu
</pre>

</body>
</html>
