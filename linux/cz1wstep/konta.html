<html>
<head>
<title>Konta</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2">
</head>

<body bgcolor="white" text="black" link="blue" vlink="navy" alink="red">

<h1>Konta u¿ytkowników</h1>

<h3>INFORMACJE</h3>

<p>Podrêcznik systemowy <em>man</em>: useradd, userdel, passwd, 
chown, chgrp, usermod, group, groupadd, groupdel, newgrp, groupmod.

<p>Debian: adduser, addgroup, deluser, delgroup

<h3>PLIKI</h3>

<pre>
/etc/skel
/etc/passwd        (spis kont u¿ytkowników)
/etc/group         (grupy istniej±ce w systemie)
/etc/shadow         (istnieje, je¿eli u¿ywamy "shadow passwords")
/etc/shells        (pow³oki dostêpne w systemie)
/etc/login.defs   (ustawienia domy¶lne dla kont)
</pre>

<h3>OPIS</h3>

<p>Ka¿dy u¿ytkownik, który loguje siê w Linuksie jest identyfikowany
w oparciu o konto u¿ytkownika. Konto u¿ytkownika kontroluje dostêp
do systemu, definiuj±c nazwê u¿ytkownika i has³o, które uwierzytelnia
u¿ytkownika podczas procesu logowania siê. Do kontroli przywilejów
zalogowanego u¿ytkownika wykorzystywane s± identyfikator u¿ytkownika
(UID) i identyfikator grupy (GID), odpowiadaj±ce kontu u¿ytkownika.
Warto¶ci te, zdefiniowane podczas tworzenia konta u¿ytkownika,
kontroluj± bezpieczeñstwo systemu plików i identyfikuj±, który
u¿ytkownik kontroluje dany proces.

<p>Podstawowy proces dodawania konta u¿ytkownika jest taki sam 
we wszystkich systemach linuksowych. Dodanie konta u¿ytkownika wymaga 
nastêpujacej procedury:
<ul>
<li> edycji pliku <em>/etc/passwd</em>, aby zdefiniowaæ nazwê u¿ytkownika, 
UID, GID, katalog domowy i pow³okê logowania dla danego u¿ytkownika
<li> ustawienia has³a dla u¿ytkownika 
za pomoc± polecenia <em>passwd</em>
<li> utworzenia katalogu domowego za pomoc± polecenia <em>mkdir</em>
<li> skopiowania domy¶lnych plików inicjalizuj±cych z katalogu 
<em>/etc/skel</em> do katalogu domowego u¿ytkownika
<li> zmiany w³a¶ciciela katalogu domowego i znajduj±cych siê 
w nim plików, tak aby u¿ytkownik mia³ pe³ny dostêp do swoich plików;
przyk³adowe polecenie to 
<pre>
chown -R andrzej:users /home/andrzej
</pre>
</ul>

<p>Istnieje polecenie <em>useradd</em>, które automatycznie
wykonuje powy¿sze czynno¶ci.
Bardziej nowoczesne polecenie to <em>adduser</em>, którego
zachowanie mo¿na kontrolowaæ przez opcje linii poleceñ
i plik konfiguracyjny [Linux Debian].

<p>Wszyscy u¿ytkownicy w systemie Linux maj± odpowiedni wpis 
w pliku <em>/etc/passwd</em>. Wpisy w tym pliku maj± format:
<pre>
u¿ytkownik:has³o:UID:GID:tekst:katalog:shell
</pre>

<p>S± tu wpisy dla kont prawdziwych u¿ytkowników oraz wpisy 
dla kont specjalnych utworzonych dla programów, 
które musz± kontrolowaæ procesy
lub które tworz± b±d¼ usuwaj± pliki.

<p>UID jest niepowtarzalnym identyfikatorem u¿ytkownika.
UID jest liczb± z zakresu od 0 do 32767 (nie zawsze!). 
Liczby poni¿ej 100 s± zarezerwowane dla specjalnych kont systemowych.
Red Hat Linux rezerwuje liczby od 0 do 499, a wolne s± od 500 do 60000.
Debian u¿ytkownikom nadaje liczby od 1000 w górê.

<p>Pole GID jest wykorzystywane do identyfikacji grupy podstawowej
u¿ytkownika. Warto¶ci GID z zakresu od 0 do 499 s± zwykle
zarezerwowane dla kont systemowych 
(czasem rezerwuje siê warto¶ci od 0 do 99).
Grupy dla zwyk³ych u¿ytkowników le¿± w przedziale
od 500 do 60000 (Red Hat Linux).

<p>Istniej±ce grupy zapisane s± w pliku <em>/etc/group</em>.
Wpisy w tym pliku maja format:
<pre>
nazwa_grupy:has³o:GID:lista_u¿ytkowników
</pre>

<p>Grupa g³ówna u¿ytkownika jest przypisana 
w pliku <em>/etc/passwd</em>.
Lista w pliku <em>/etc/group</em> jest u¿ywana do przypisania u¿ytkownika
do dodatkowych grup.

<p>Nazwy dozwolonych pow³ok dla u¿ytkowników s± zapisane w pliku
<em>/etc/shells</em>. Je¿eli dodamy now± pow³okê do systemu, 
dodajemy jej nazwê do pliku <em>/etc/shells</em>.
Typowa zawarto¶æ pliku <em>/etc/shells</em>:
<pre>
/bin/bash          (Bourne Again Shell)
/bin/sh           (Bourn Shell - link do /bin/bash)
/bin/tcsh         (Tenex C Shell)
/bin/csh          (C Shell - link do /bin/tcsh)
/bin/ash         (A Shell)
/bin/bsh          (B Shell - link do /bin/ash)
/usr/bin/pine     (moj dopisek dla kont specjalnych)
</pre>

<p>Polecenie <em>umask</em> ustawia domy¶lne prawa dostêpu 
do tworzonych plików i katalogów (ustawia siê które prawa zabraæ).
Wystêpuje ono np. w pliku <em>/etc/profile</em> i jest wykonywane
podczas otwierania sesji.
Zwykle mamy takie prawa dostêpu:
<pre>
plik 644 (umask 133)
katalog 755 (umask 022)
</pre>

<p>Red Hat - narzêdzie do konfiguracji typu uwierzytelniania to 
<em>authconfig</em> (dostêpny wprost lub przez <em>setup</em>).


<h3>ZAK£ADANIE KONTA</h3>

<p>Mo¿na zrobiæ to rêcznie w trybie tekstowym lub wykorzystaæ
jakie¶ narzêdzie graficzne, np. <em>linuxconf</em>
(Users accounts | Normal | User accounts).
Rêczne zak³adanie konta dla zwyk³ego u¿ytkownika 
<em>user1</em> z grupy <em>users</em>:
<pre>
[root]# useradd -g users user1
[root]# passwd user1                 (dwa razy wpisujemy has³o)
                                 (tak mo¿na zmieniæ zapomniane has³o)
[root]# chfn user1            (informacje dla polecenia finger)
[root]# useradd -s /usr/bin/pine user2   (wybór login shell)
[root]# useradd -u uid user3            (wybór UID)
</pre>

<p>W Debianie warto korzystaæ z nowoczesnego polecenia
<em>adduser</em>, które ma w³asny plik konfiguracyjny
<em>/etc/adduser.conf</em>.

<h3>USUWANIE KONTA</h3>

<p>Mo¿na wykorzystaæ <em>linuxconf</em> lub zrobiæ to rêcznie:
<pre>
[root]# userdel user1
</pre>

<p>Trzeba jeszcze recznie usunac katalog <em>/home/user1</em> 
i pliki tego u¿ytkownika w systemie. 
Usuwany u¿ytkownik nie mo¿e byæ zalogowany
i nie mo¿e mieæ dzia³aj±cych procesów.
<pre>
[root]# userdel -r user1                 (usunie katalog domowy)
</pre>

<p>W Debianie warto korzystaæ z nowoczesnego polecenia
<em>deluser</em>, które ma w³asny plik konfiguracyjny
<em>/etc/deluser.conf</em>.

<h3>ZMIANA W£A¦CICIELA LUB GRUPY DLA PLIKU</h3>

<pre>
[root]# chown user2 plik1
[root]# chown user2:grupa2 plik1     (zmiana wlasciciela i grupy)
[root]# chown :grupa2 plik1         (zmiana tylko grupy, jak chgrp)
[root]# chown -R user2:grupa2 kat1
        (rekurencyjna zmiana w³a¶ciciela i grupy w podkatalogach)
$ chgrp grupa2 plik1               (przypisanie pliku do grupy)
</pre>

<h3>ZMIANA GRUPY DLA U¯YTKOWNIKA</h3>

<pre>
[root]# groupadd -g gid grupa1      (utworzenie nowej grupy z GID=gid)
[root]# groupdel grupa1
            (usuniêcie grupy; pliki trzeba rêcznie poprawiaæ)
[root]# groupmod -g gid grupa1
             (zmiana GID dla grupy; pliki trzeba recznie poprawiaæ)
[root]# groupmod -n grupa2 grupa1    (zmiana nazwy z grupa1 na grupa2)
[root]# usermod -G grupa2 user1       (przypisanie czlowieka do grupy)

$ newgrp grupa2                        (log in to a new group)
$ newgrp                               (powrot do login group)
</pre>

</body>
</html>
