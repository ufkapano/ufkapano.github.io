<html>
<head>
<title>Linux+</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2">
</head>

<body bgcolor="white" text="black" link="blue" vlink="navy" alink="red">

<p>Linux+ 2003/4

<h1>
J±dro - to nie takie straszne!
</h1>

<p>
Najwa¿niejsz± czê¶ci± ka¿dego systemu operacyjnego jest j±dro 
(ang. <em> kernel</em>). W Linuksie pe³ni ono m. in. 
rolê po¶rednika pomiêdzy oprogramowaniem a sprzêtem, gdy¿ zajmuje 
siê zarz±dzaniem zasobami (procesora, pamiêci, przestrzeni dyskowej), 
które przydziela uruchamianym programom.

<p>
Wraz z ka¿d± dystrybucj± Linuksa dostarczane jest domy¶lnie 
skonfigurowane j±dro. Mo¿na zadaæ wiêc pytanie, po co 
w ogóle kompilowaæ w³asne j±dro? Powody s± ró¿ne, ale jeden z 
nich jest taki, ¿e domy¶lne j±dro zbudowane jest z my¶l±  
o tym, aby dzia³a³o na jak najwiêkszej liczbie ró¿norodnych 
konfiguracji sprzêtowych,  a to oznacza, ¿e nie wykorzystuje ono 
optymalnie naszego sprzêtu. Czasem mo¿e zdarzyæ siê tak¿e, ¿e 
mamy zainstalowany w komputerze sprzêt, który obs³ugiwany jest dopiero 
przez nowsz± wersjê j±dra - warto wtedy skonfigurowaæ nowsze 
j±dro samodzielnie.

<p>
Zanim przejdziemy do pobierania ¼róde³, chcia³bym wyja¶niæ sprawê 
numeracji wersji j±dra. Sk³ada siê ona z trzech liczb oddzielonych 
kropkami. Pierwsza z nich (obecnie jest to 2) to w³a¶ciwy numer 
wersji (ang. <em>version</em>). Druga liczba (okre¶lana angielskim 
s³owem <em> patchlevel</em>) pozwala okre¶liæ, czy j±dro jest 
stabilne (uznane za wolne od dziur i b³êdów, przeznaczone dla 
ogó³u u¿ytkowników), czy te¿ rozwojowe (przeznaczone dla osób, 
które chc± testowaæ nowe j±dra, wprowadzaæ do nich jakie¶ 
zmiany czy wspó³pracowaæ przy ich rozwoju). Je¿eli druga liczba 
jest parzysta, to mamy do czynienia z j±drem stabilnym 
(co nie znaczy, ¿e ju¿ ca³kiem wolnym od b³êdów!), natomiast 
liczba nieparzysta okre¶la j±dro rozwojowe. Ostatnia z trzech 
liczb okre¶la numer kolejny (ang. <em>sublevel</em>) w danej serii 
j±der. W chwili pisania artyku³u najnowsze stabilne j±dra nosi³y 
numery 2.2.23 oraz 2.4.20. Wybór pomiêdzy j±drem ga³êzi 2.2 a 2.4 
zale¿y od naszych potrzeb - j±dra ga³êzi 2.2 s± lepiej przetestowane i 
bardziej stabilne, ale nie obs³uguj± tylu urz±dzeñ, co wersje 2.4.

<h3>
Pobieranie ¼róde³ j±dra
</h3>

<p>
Przed rozpoczêciem konfiguracji j±dra musimy posiadaæ jego ¼ród³a 
na dysku. Mo¿e zdarzyæ siê, ¿e s± one ju¿ zainstalowane
 - sprawdzamy to wchodz±c do katalogu <em> /usr/src/.</em> 
Je¿eli znajduje siê w nim katalog o nazwie <em> linux-x.y.z,</em> 
gdzie <em> x.y.z </em> to odpowiadaj±ca nam wersja j±dra (przyk³adowo 
2.2.19 lub 2.4.20), to mo¿emy od razu przej¶æ do rozdzia³u <em> 
Konfiguracja j±dra.</em> W innym przypadku mo¿emy pobraæ ¼ród³a z 
serwera <em> ftp.kernel.org </em> lub z którego¶ z serwerów 
lustrzanych (ang. <em> mirror</em>), np. korzystaj±c z adresu <em> 
ftp.pl.kernel.org/pub/linux/kernel/.</em> Mo¿na je równie¿ znale¼æ na 
p³ytach z dystrybucj± (niekoniecznie bêd± to jednak najnowsze wersje) 
lub na p³ytach do³±czanych do pism (na przyk³ad do <em> Linux+</em>). 
Gdy ju¿ skopiujemy odpowiedni plik na dysk, przenosimy go do 
katalogu <em> /usr/src/.</em> a tam rozpakowujemy odpowiedni± 
komend±, np. <tt> tar xzvflinux-2.4.20.tar.gz.</tt>
 
<p>
Warto wspomnieæ o mo¿liwo¶ci nak³adania ³atek (ang. <em> patches</em>) 
na j±dro. Je¿eli posiadamy na dysku ¼ród³a starszej wersji j±dra, 
a chcieliby¶my kompilowaæ nowsz± wersjê, to nie ma potrzeby pobierania 
ca³ego pliku (czêsto licz±cego oko³o 30MB). Zamiast tego mo¿emy 
pobraæ odpowiednie ³atki, w których zawarta jest informacja, jakie 
zmiany zasz³y w poszczególnych wersjach. Je¿eli chcemy przyk³adowo 
uaktualniæ posiadane j±dro 2.4.18 do wersji 2.4.20, to z 
wymienionych wcze¶niej ¼róde³ musimy pobraæ jedynie pliki <em> 
patch-2.4.19.gz </em> oraz <em> patch-2.4.20.gz.</em> Pliki te 
kopiujemy do katalogu ze ¼ród³ami naszego j±dra, a nastêpnie 
w tym katalogu wydajemy polecenia:
 
<pre>
gzip -cd patch-2.4.19.gz | patch  p0  
gzip -cd patch-2.4.20.gz | patch  p0
</pre>

Bardzo wa¿ne jest, aby ³atki nak³adaæ w odpowiedniej kolejno¶ci 
i tylko na "czyste" ¼ród³a (czyli bez na³o¿onych innych ³atek). 
Je¿eli wszystko przebiegnie bez problemu, to mo¿emy cieszyæ siê 
now± wersj± ¼róde³ j±dra i mniejszym rachunkiem za telefon 
(w przypadku modemowców).
 
<h3>
Konfiguracja j±dra 
</h3>

<p>
Konfiguracja j±dra znajduje siê w pliku <em> .confing </em> w katalogu 
ze ¼ród³ami. Je¿eli konfigurowali¶my wcze¶niej j±dro lub mamy 
zachowany 
plik konfiguracyjny, to jest to dobry moment, aby skopiowaæ go we 
w³a¶ciwe miejsce. Zachowywanie pliku konfiguracyjnego jest wa¿ne, 
je¿eli staramy siê doszlifowaæ nasze j±dro - dziêki temu nie 
bêdziemy musieli zmieniaæ wszystkich ustawieñ, a jedynie te, które 
jeszcze sprawiaj± problemy.
 
<p> 
Kolejnym krokiem jest wyczyszczenie plików obiektowych pozosta³ych 
po poprzednich kompilacjach. Dokonujemy tego wydaj±c polecenie 
<tt> make clean.</tt> Dok³adniejsze czyszczenie wykonywane jest 
po wydaniu polecenia <tt> make mrproper,</tt> ale korzystaj±c z 
niego nale¿y pamiêtaæ o skopiowaniu pliku <em> .confing </em> w 
bezpieczne miejsce, gdy¿ zostanie on usuniêty.

<p>
W³a¶ciwej konfiguracji j±dra mo¿emy dokonaæ na kilka sposobów. 
Pierwszy z nich polega na wywo³aniu polecenia <tt> make confing. 
</tt> W tym przypadku bêdziemy odpowiadaæ na kolejno zadawane pytania. 
Osobi¶cie nie polecam tej opcji, gdy¿ w razie pomy³ki trzeba 
zaczynaæ ca³y proces od pocz±tku. Druga mo¿liwo¶æ to konfiguracja 
j±dra 
z u¿yciem przyjemnego menu na konsoli lub w oknie terminala, 
wywo³ywana 
poleceniem <tt> make menuconfing.</tt>
Moim zdaniem jest to najwygodniejszy 
sposób. Trzecia metoda, <tt> make xconfing,</tt> przeznaczona jest 
dla fanów 
interfejsu graficznego. Ostatnia mo¿liwo¶æ to <tt> make oldconfing,
</tt> 
ale po jej wybraniu nie odpowiadamy na ¿adne pytania, gdy¿ j±dro 
konfigurowane jest zgodnie z opcjami zawartymi w starym pliku 
konfiguracyjnym <em> .confing </em> (o ile istnieje).

<p>
Niezale¿nie od tego, ktor± z trzech pierwszych mo¿liwo¶ci wybierzemy, 
nasze zadanie bêdzie polega³o na zapoznaniu siê z dostêpnymi opcjami 
i wybraniu tych, które s± nam potrzebne. Najczê¶ciej bêdziemy mogli 
wykonaæ to na trzy sposoby: wkompilowaæ opcjê w j±dro na stale 
([<em>Y</em>]), jako modu³ ([<em>M</em>]) lub nie wkompilowywaæ 
([<em>N</em>]). Na temat wielu opcji bêdziemy mogli uzyskaæ przydatne 
informacje ([<em>?</em>]), w których czêsto zawarte s± wskazówki, 
czy dan± opcjê nale¿y wkompilowaæ, czy te¿ lepiej j± wy³±czyæ.

<p>
W±tpliwo¶ci Czytelników mo¿e wzbudzaæ rozró¿nienie pomiêdzy 
wkompilowywaniem opcji w j±dro na sta³e a kompilowaniem jej jako 
modu³. Generalnie nale¿y wkompilowaæ w j±dro tylko te sk³adniki, 
które s± bezwzglêdnie konieczne podczas uruchamiania systemu 
(np. obs³ugê systemu plików wykorzystywanego na partycji z Linuksem) 
lub takie, które bêd±  wykorzystywane przez wiêkszo¶æ czasu 
(np. sterowniki karty sieciowej). Jako modu³y mo¿emy skompilowaæ 
elementy opcjonalne, które bêd± wykorzystywane okazjonalnie 
(np. sterowniki urz±dzeñ pod³±czanych do portu USB). 
Zalet± przeniesienia czê¶ci sterowników do modu³ów jest zmniejszenie 
rozmiaru j±dra oraz zajêto¶ci pamiêci (modu³y s± ³adowane do pamiêci 
tylko wtedy, gdy s± potrzebne). 

<p>
Po tych wyja¶nieniach mo¿emy ju¿ zacz±æ przedzieraæ siê przez g±szcz 
opcji konfiguracyjnych. W czasie konfigurowania bêd± nam jeszcze 
potrzebne informacje na temat naszego sprzêtu, takie jak typ 
procesora, <em> chipset </em> p³yty g³ównej, typ karty graficznej, 
d¼wiêkowej, sieciowej oraz innych zamontowanych w naszym komputerze. 
Sama konfiguracja polega, jak ju¿ wspomnia³em, na przejrzeniu 
wszystkich opcji i wybraniu tych, które s± nam potrzebne.  
Dla u³atwienia opiszê poni¿ej kilka g³ównych sekcji konfiguracyjnych 
i zwrócê uwagê na opcjê, które bezwzglêdnie powinny byæ w³±czone. 
Uwagi te odnosz± siê przede wszystkim do konfiguracji j±der z linii 
2.4. gdy¿ w j±drach ga³êzi 2.2 niektóre opcje mog± byæ 
umieszczone w innych sekcjach.
 
<h3>
Code maturity level options
</h3>

<p>
Ustawienie opcji <em> Prompt for development and/ or incomplete 
code/drivers </em> da nam dostêp  do wiêkszej ilo¶ci przydatnych 
opcji oraz sterowników. Nie nale¿y baæ siê tej opcji, a jedynie 
podczas konfiguracji zwróciæ baczn± uwagê na pozycje 
zaznaczone jako <em> EXPERIMENTAL </em> - nie wszystkie 
s± stabilne.
  
<h3>
Loadable module support
</h3>

<p>
Tutaj nale¿y w³±czyæ wszystkie opcje - dziêki temu bêdziemy mogli 
skompilowaæ 
czê¶æ elementów j±dra jako modu³y.

<h3>
Processor type and features
</h3>

<p>
Przede wszystkim ustawiamy odpowiedni typ procesora. Je¶li 
chcemy wykorzystywaæ kompilowane j±dro równie¿ na innych komputerach, 
to mo¿emy wybraæ opcjê <em> i386</em> - przy takim ustawieniu 
uruchomi 
siê ono na wszystkich komputerach klasy PC. W innym przypadku lepiej 
wybraæ opcjê w³a¶ciw± dla posiadanego przez nas procesora - dziêki 
temu j±dro bêdzie najlepiej zoptymalizowane. 

<p>
Warto zaznaczyæ tak¿e opcjê <em> MTRR, </em> szczególnie, je¿eli 
zamierzamy na naszym komputerze ogl±daæ filmy.
 
<h3>
General setup
</h3>

<p>
Obowi±zkowo nale¿y zaznaczyæ opcjê <em> Networking support</em> 
- nawet je¶li nasz komputer nie bêdzie pod³±czony do ¿adnej sieci. 
Konieczne jest równie¿ zaznaczenie opcji <em> Kernel support for 
ELF binaries,</em> a je¿eli posiadamy p³ytê PCI - opcji <em> PCI 
support.</em>
 
<h3>
Parallel port support
</h3>
 
<p>
Opcje <em> Parallel port support </em> oraz <em> PC-style hardware 
</em> mo¿emy zaznaczyæ jako modu³y. Z pewno¶ci± przydadz± siê, 
je¿eli korzystamy z urz±dzeñ podpiêtych do portu równoleg³ego 
(np. drukarki).
 
<h3>
Plug and Play configuration 
</h3>

<p>
Warto wykorzystaæ moc drzemi±c± w technologii <em> Plug & Play,</em> 
wiêc zaznaczamy wszystkie dostêpne tu opcje.
 
<h3>
Block devices
</h3>

<p>
Wiêkszo¶æ Czytelników z pewno¶ci± zechce zaznaczyæ opcjê <em> 
Normal PC floppy disc support,</em> dziêki której nasz Linux 
bêdzie obs³ugiwa³ stacjê dyskietek. 
Oprócz tego mo¿e przydaæ siê nam opcja <em> Loopback device 
support</em> - szczególnie warto¶ciowa dla posiadaczy nagrywarek 
CD, ale nie tylko. Mo¿na j± skompilowaæ jako modu³. 

<h3>
Networking options
</h3>

<p>
Koniecznie nale¿y zaznaczyæ opcjê <em> Unix domain sockets </em> 
oraz <em> TCP/IP networking.</em> Poza tym, w tej sekcji znajduj± 
siê opcje dotycz±ce zapory sieciowej (ang. <em> firewall,</em>) 
serwerów wirtualnych oraz sprawiedliwego dzielenia ³±cza. 
Przy wybieraniu odpowiednich opcji z pewno¶ci± pomog± opisy 
dostêpne pod przyciskiem [<em>?</em>].
 
<h3>
ATA/IDE/MFM/RLL support 
</h3>

<p>
Warto zaznaczyæ opcje <em> Enhanced IDE/MFM/RLL disk/cdrom/tape/
floppy support, Include IDE/ATA-2 DISK support </em> oraz <em> 
Include IDE/ATAPI CDROM support.</em> Posiadacze nagrywarek 
CD powinni zaznaczyæ równie¿ opcjê <em> SCSI emulation 
support.</em>
 
<h3>
SCSI support
</h3>

<p>
Je¿eli nie posiadamy urz±dzeñ SCSI, to mo¿emy wy³±czyæ dostêpne 
tu opcje. Wyj±tkiem s± posiadacze nagrywarek CD oraz niektórych 
aparatów i kamer cyfrowych, którzy powinni zaznaczyæ opcjê <em> 
SCSI support.</em> oraz <em> SCSI generic support.</em> 
Obydwie mo¿na skompilowaæ jako modu³y.
 
<h3>
Network device support
</h3>

<p>
Je¿eli zamierzamy pod³±czyæ nasz komputer do sieci, zaznaczamy 
opcjê <em> Network dewice support.</em> Nastêpnie w odpowiedniej 
sekcji <em> Ethernet </em> zaznaczamy sterownik posiadanej 
przez nas karty sieciowej. Warto wkompilowaæ go na sta³e w j±dro. 
Posiadacze modemów powinni zaznaczyæ opcjê <em> PPP support.</em>
 
<h3>
Character devices 
</h3>

<p>
Je¿eli chcemy normalnie korzystaæ z naszego Linuksa, nie mo¿emy 
zapomnieæ o zaznaczeniu opcji <em> Virtual terminal. </em> 
Je¿eli tego nie zrobimy, jedyn± mo¿liwo¶ci± uzyskania dostêpu 
do Linuksa bêdzie u¿ycie ³±cza szeregowego lub po³±czenia 
sieciowego. Wy³±czenie tej opcji ma wiêc tylko sens w urz±dzeniach 
wbudowanych (ang. <em> embedded</em>). Nastêpnie zaznaczamy obs³ugê  
 drukarki - <em> Parallel printer support. </em> W sekcji <em> Mice 
</em> mo¿na zaznaczyæ obs³ugê myszki PS/2, je¿eli tak± posiadamy. 

<h3>
File systems
</h3>

<p>
Nale¿y wkompilowaæ obs³ugê wszystkich systemów plików, które 
wykorzystujemy na posiadanych przez nas dyskach. Najczê¶ciej 
 bêd±  to: <em> Second extended, ext3, ISO 9660. DOSFAT, MSDOS,VFAT, 
NTFS </em> (tylko do odczytu). Oprócz tego nale¿y wkompilowaæ obs³ugê 
systemu <em> /proc. </em> Warto te¿ w³±czyæ opcjê <em> Microsoft 
Joliet CDROM extension, </em> a w sekcji <em> Network Fille Systems 
</em> zaznaczyæ <em> SMB file system support </em> (pozwoli nam to 
uzyskaæ dostêp do zasobów udostêpnionych w sieci przez komputery z 
zainstalowanym systemem Windows). 

<h3>
Console drivers
</h3>

<p>
Zaznaczamy opcjê <em> VGA text console </em> oraz <em> Video mode 
selection support. </em> Chêtni mog± w sekcji <em> Frame-buffer 
support </em> zaznaczyæ odpowiednie opcje do obs³ugi bufora ramki 
(pozwoli nam to na wy¶wietlanie grafiki oraz ogl±danie filmów bez 
konieczno¶ci uruchamiania X Window). 

<h3>
Sound
</h3>

<p>
Zaznaczamy opcje odpowiednie dla naszej karty d¼wiêkowej. 
Nale¿y pamiêtaæ, ¿e nie wszystkie karty obs³ugiwane s± przez j±dro, 
a czê¶æ jest obs³ugiwana przez sterowniki ALSA dostêpne w Sieci 
(<em>http://www.alsa-project.org/</em>). 

<h3>
USB support
</h3>

<p>
Je¿eli korzystamy z USB, to warto zaznaczyæ opcjê <em> Support 
for USB </em> oraz skompilowaæ wszystkie sterowniki jako modu³y 
- dziêki temu bêdziemy mogli bez ponownej kompilacji j±dra 
skorzystaæ z ka¿dego obs³ugiwanego urz±dzenia, które zostanie 
pod³±czone do komputera. 

<h3>
Kernel hacking
</h3>

<p>
Generalnie najlepiej opcje zawarte w tej sekcji pozostawiæ 
wy³±czone. Wiêkszo¶æ z nich przeznaczona jest dla pracuj±cych 
nad rozwojem j±dra. Wyj±tkiem jest tutaj tzw. "Magiczny klawisz", 
który mo¿e bardzo pomóc w krytycznych sytuacjach. Umo¿liwiamy 
sobie jego u¿ycie wybieraj±c opcje <em> Kernel debugging </em> 
oraz <em> MagicSysRq key, </em> a opis sposobów jego wykorzystania 
mo¿emy znale¼æ w pliku <em> Documentation/sysrq.txt </em> w 
katalogu ze ¼ród³ami j±dra. 

<h3>
Kompilacja j±dra 
</h3>

<p>
Po zakoñczeniu konfiguracji jeste¶my informowani o konieczno¶ci 
wywo³ania polecenia <tt> make dep. </tt> Spowoduje ono utworzenie 
zale¿no¶ci (ang. <em> dependencies</em>) pomiêdzy plikami ¼ród³owymi. 
Po zakoñczeniu wykonywania tego polecenia mo¿emy uruchomiæ w³a¶ciw± 
kompilacjê j±dra poleceniem <tt> make bzImage. </tt> Zale¿nie od mocy 
posiadanego przez nas sprzêtu, kompilacja mo¿e potrwaæ od kilku minut 
do kilku(nastu) godzin, a w tym czasie przez ekran bêdzie przewijaæ 
siê mnóstwo komunikatów. Po zakoñczeniu tego etapu mo¿emy skompilowaæ 
modu³y (<tt>make modules</tt>), a nastêpnie je zainstalowaæ (<tt>
make modules_install</tt>). 

<p>
Je¿eli u¿ywamy dystrybucji korzystaj±cej z pakietów <em> rmp, </em> 
to z pewno¶ci± ucieszy nas mo¿liwo¶æ stworzenia pakietu ze 
skompilowanym przez nas j±drem. Wystarczy w takim przypadku 
wykonaæ polecenie  <tt> make rmp, </tt> a w katalogu <em> /usr/src/
rpm/RPMS/i386/ </em> pojawi siê potrzebny nam pakiet. Z pewno¶ci± 
oszczêdzi nam to k³opotów z instalowaniem i odinstalowywaniem 
j±dra, ale warto, choæby dla samej wiedzy, przynajmniej raz 
samodzielnie zainstalowaæ j±dro zgodnie z dalszymi wskazówkami.
 
<h3>
Instalowanie nowego j±dra
</h3>

<p>
Nasze nowe j±dro znajduje siê w pliku <em> arch/i386/boot/bzImage 
</em> (licz±c od katalogu, w którym kompilowali¶my ¼ród³a). 
Teraz musimy zainstalowaæ je w katalogu <em> /boot. </em> 
Nale¿y uwa¿aæ, aby nie nadpisaæ pliku ze starym j±drem. 
Z tego powodu dobrym zwyczajem jest dodawanie numeru wersji 
do nazwy pliku j±dra, np. <em> bzImage-2.4.20. </em> W zasadzie 
nie ma znaczenia, jak bêdzie nazywa³o siê j±dro (mo¿e nazywaæ siê 
przyk³adowo <em> umlinuz-2.4.20</em>), ale wa¿ne jest, aby nazwa 
by³a dla nas czytelna. Nastêpnie wracamy do  katalogu, w którym 
kompilowali¶my j±dro, po czym poleceniem <tt> cp System.map/boot/
System.map-2.4.20 </tt> kopiujemy plik <em> System.map </em> 
nadaj±c mu od razu nazwê stosown± do numeru wersji skompilowanego 
j±dra. Chocia¿ nie jest to konieczne, warto zachowaæ równie¿ plik 
konfiguracyjny j±dra (<em>.confing</em>). W tym celu najlepiej 
skopiowaæ go do katalogu <em> /boot </em> pod nazw± <em> 
confing-2.4.20 </em> - dziêki temu ³atwo bêdzie pó¼niej wprowadzaæ 
ewentualne poprawki do konfiguracji. 

<p>
Je¿eli chcemy przetestowaæ nasze nowe j±dro, mo¿emy po prostu nagraæ 
je na dyskietkê, z której nastêpnie uruchomimy system. S³u¿y do tego 
polecenie <tt> mkbootdisk --device/dev/fd0 2.4.20, </tt> gdzie 
w miejsce liczb 2.4.20 wstawiamy numer wersji j±dra, które chcemy 
zapisaæ na dysku. Polecenie to sformatuje dyskietkê 
(<em> /dev/fd0 </em>
to odpowiednik DOSowskiego napêdu <em> A:, </em> ale 
je¿eli chcemy zapisaæ j±dro na dyskietce w stacji <em> B:, </em> 
to wpisujemy <em> /dev/fd1</em>), a nastêpnie zapisze na niej plik 
j±dra.

<p>
Je¿eli nie chcemy korzystaæ z dyskietki, a mamy zainstalowany ktory¶ 
z programów uruchomieniowych (ang. <em> bootloader</em>), to musimy 
zmieniæ jego konfiguracjê. Poni¿ej opisane s± zmiany, które nale¿y 
wprowadziæ w przypadku u¿ywania <em> LILO </em> lub <em> GRUB-a, 
</em> aby móc bezpiecznie przetestowaæ nowe j±dro.

<h3>
LILO
</h3>

<p>
W pliku <em> /etc/lilo.conf </em> znajduj± siê ju¿ zapewne wpisy 
dla obecnego j±dra, które wygl±daj± przyk³adowo tak: 

<pre>
image=/boot/vmlinuz-2.4.18
   label=linux
   root=/dev/hda2
   read-only
</pre>

Poni¿ej tych linii mo¿emy dopisaæ informacjê o naszym nowym 
j±drze, które mog± wygl±daæ tak:

<pre>
image=/boot/vmlinuz-2.4.20
   label=linux.nowy
   root=/dev/hda2
   read_only
</pre>

Jak widaæ zmienia siê tylko ¶cie¿ka do pliku z j±drem (musimy 
podaæ nazwê, pod któr± skompilowali¶my plik j±dra) oraz nazwa 
pozycji. Je¿eli w tym pliku nie ma linii o tre¶ci <tt> prompt, 
</tt> to nale¿y j± dopisaæ - dziêki temu podczas uruchamiania 
systemu zostaniemy zapytani, które j±dro ma byæ za³adowane. 

<p>
Po wprowadzeniu zmian do pliku <em> /etc/lilo.conf </em> 
koniecznie trzeba pamiêtaæ o uruchomieniu polecenia <tt> 
lilo. </tt> 

<p>
Gdy ju¿ stwierdzimy, ¿e jeste¶my zadowoleni z naszego nowego 
j±dra, mo¿emy w pliku <em>/etc/lilo.conf </em> dopisaæ (lub 
poprawiæ, je¶li ju¿ tam jest) liniê: 

<pre>
default=linux.nowy
</pre>

<p>
Nie zapomnijmy o ponownym uruchomieniu polecenia <tt> lilo! </tt> 

<h3>
GRUB
</h3>

<p>
W przypadku GRUBa zmiany s± jeszcze prostsze. W pliku <em> 
/etc/grub.conf </em> (lub <em> /boot/grub/grub.conf</em>) 
odnajdujemy linie odpowiedzialne za ³adowanie dotychczasowego 
j±dra. Powinny one wygl±daæ mniej wiêcej tak:

<pre>
title Linux
kernel (hd1.0)/vmlinuz-2.4.18 root=/dev/hdb1
</pre>

<p>
Poni¿ej nich dopisujemy linie dla nowego j±dra:

<pre>
title Linux.nowy
kernel (hd1.0)/vmlinuz-2.4.20 root=/dev/hdb1
</pre>

<p>
Jak widaæ, równie¿ w tym przypadku zmieniamy tylko nazwê pozycji 
i pliku j±dra. Pozosta³e informacjê pozostaj± takie same, jak w 
przypadku poprzedniego j±dra.
 
<h3>
Zakoñczenie 
</h3>

<p>
To ju¿ wszystko, wiêc mo¿emy ponownie uruchomiæ komputer i 
sprawdziæ, jak funkcjonuje nasze j±dro. Jak widaæ proces 
konfiguracji oraz kompilacji j±dra nie jest rzecz± szczególnie 
skomplikowan±, chocia¿ wymaga on pewnej wiedzy, której nie da siê 
przekazaæ w krótkim artykule. Warto zapoznaæ siê z dokumentacj± 
zawart± w ¼ród³ach, jak równie¿ z informacjami znajduj±cymi siê 
w Sieci. Pozwoli to z czasem skonfigurowaæ j±dro tak, ¿e bêdziemy 
z niego ca³kiem zadowoleni. A wtedy... pojawi siê kolejna wersja 
j±dra, oferuj±ca nowe mo¿liwo¶ci, ale nam bêdzie ju¿ o wiele 
³atwiej zapoznaæ siê z nimi oraz je wykorzystaæ.

<h3>
W sieci
</h3>

<p>
<ul>
<li>
G³ówna strona po¶wiêcona j±dru Linuksa 
- <em> http://www.kernel.org/ </em> 
<li>
Polskie t³umaczenie Kernel-HOWTO 
- <em> http://www.jtz.org.pl/Html/Kernel-HOWTO.pl.html </em> 
<li>
Oryginalny tekst Kernel-HOWTO 
- <em> http://www.linuxdoc.org/HOWTO/Kernel-HOWTO.html </em>        
</ul>

<h3>
Porz±dek w modu³ach 
</h3>

<p>
Je¿eli kilkakrotnie kompilujemy j±dro w tej samej wersji, w 
katalogu <em> /lib/modules/ </em> mo¿e zrobiæ siê nam niez³y 
ba³agan. W stosunkowo prosty sposób mo¿emy tego unikn±æ - nale¿y 
wyedytowaæ plik <em> Makefile, </em> który znajduje siê w 
katalogu ze ¼ród³ami j±dra. Zobaczymy tam linie w postaci:

<pre>
VERSION = 2
PATCHLEVEL = 4
SUBLEVEL = 20
EXTRAVERSION = 
</pre>

<p>
Przy takim ustawieniu modu³y bêd± instalowane w podkatalogu <em> 
2.4.20/. </em> W przypadku kilkakrotnej kompilacji z ró¿nymi 
opcjami chcieliby¶my jednak, aby modu³y by³y umieszczane w osobnych 
podkatalogach. Mo¿emy zatem zmieniæ jedn± linijkê na:

<pre>
EXTRAVERSION = -moje-1
</pre>

<p>
Dziêki tej zmianie modu³y trafi± do podkatalogu <em> 2.4.20-moje-1. 
</em> Warto przy tym pamiêtaæ, aby pozosta³e pliki nazywaæ 
konsekwentnie: <em> vmlinuz-2.4.20-moje-1, System.map-2.4.20-moje-1 
</em> oraz <em> config-2.4.20-moje-1. </em> 
Gdy nie bêdziemy jeszcze ca³kiem zadowoleni z naszego j±dra, to 
przed zmian± konfiguracji zwiêkszymy liczbê w <em> Makefile </em> 
o jeden uzyskuj±c:

<pre>
EXTRAVERSION = -moje-2
</pre>

<p>
Ostatecznie ³atwo bêdziemy mogli okre¶liæ, które pliki w katalogu 
<em>/boot </em> oraz które podkatalogi w <em> /lib/modules </em> 
s± nam niepotrzebne. 
  
</body>
</html>
